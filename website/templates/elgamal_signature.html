{% extends 'base.html' %}
{% block title%}
cryptoTools
{% endblock%}
{% block content %} 
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/elgamal.css') }}">
        <script src="{{ url_for('static', filename='js/elgamal.js') }}"></script>

        <div class="elgamal-section">
            <div class="elgamal-container">
                <h1>Elgamal Signature (explained step by step)</h1>
                <p>Here you can see how to sign and verify using the Elgamal procedure step by step.</p>
                
                <!-- Step 1: Enter Parameters -->
                <div>
                <h2>Step 1: Enter Parameters</h2>
                <form id="params-form">
                    <div>
                        <label for="p">Prime number (p):
                        </label>
                        <input type="number"id="p"placeholder="Enter prime number"required>
                    </div>
                    <div>
                        <label for="g">Generator (α):</label>
                        <input type="number"id="alpha"placeholder="Enter prime number"required>
                    </div>
                    <div>
                        <label for="x">Private key (a):</label>
                        <input type="number"id="a"placeholder="Enter prime number"required>
                    </div>
                    <div>
                        <button type="submit">Next Step</button>
                    </div>
                </form>
                </div>

                <!-- Step 2: Calculate Key Values -->
                <div>
                    <h2>Step 2: Calculate key values</h2>
                    <p id="beta"> <var> β = α <sup>a</sup> </var> mod <var>p</var> = </p>
                    <h3 id = "public-key">Public Key: <var>(p, α, β) =</var></h3>
                    <h3 id = "private-key">Private Key: <var>a = </var></h3>
                </div>

                <!-- Step 3: Message Signing -->
                <div>
                    <h2>Step 3: Message Signing</h2>
                    <p>Choose a random integer number <var>k</var></p>
                    <div class="input-form-group">
                        <label for="k"> <var>k =</var>  </label>
                        <input id="k" type="number" placeholder="Enter random number">
                    </div>
            
                    <div class="input-form-group">
                        <label for="message"> Message <var>x =</var>  </label>
                        <input id="message" type="number" placeholder="Enter number">
                        <select id="input-type-selector" onchange="changeInputType()">
                            <option value="number" selected>Number</option>
                            <option value="text">Text</option>
                        </select>
                    </div>

                    <p><var>&gamma; = α<sup>k</sup></var> mod <var>p</var></p>
                    <p><var>&delta; = (x- a.&gamma;).k<sup>-1</sup></var> mod <var>(p-1)</var></p>
                    <button type="button" onclick="signMessage()">Sign Message</button>
                    <p>Signature: <span id="signature"><var>sig<sub>K'</sub>(x, k) = (&gamma;,&delta;)</var></span></p>
                </div>

                <!-- Step 4: Verify Signature -->
                <div>
                    <h2>Step 4: Verify Signature</h2>
                    <p>Use the public key to verify the signature (<var>&gamma;</var>, <var>&delta;</var>):</p>
                    <p><var>v<sub>1</sub> = β<sup>&gamma;</sup>.&gamma;<sup>&delta;</sup> </var> mod <var>p</var></p>
                    <p><var>v<sub>2</sub> = α<sub>x</sub></var> mod <var>p</var></p>
                    <button type="button" onclick="verifySignature()">Verify Signature</button>
                    <p>Verification Result: <span id="verification-result"></span></p>
                </div>
            </div>
        </div>

{%endblock%}